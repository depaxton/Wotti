# מדריך הפעלה - Wotti Launcher

## סקירה כללית

נוצרו מספר קבצים שמאפשרים להפעיל את האפליקציה בקלות משולחן העבודה:

1. **launch-wotti.ps1** - סקריפט PowerShell ראשי שבודק אם האפליקציה רצה
2. **launch-wotti.bat** - קובץ batch להפעלת הסקריפט PowerShell
3. **launch-wotti.vbs** - סקריפט VBScript להפעלה ללא חלון קונסולה
4. **create-desktop-shortcut.ps1** - סקריפט ליצירת קיצור דרך בשולחן העבודה

## תכונות

### 1. בדיקה אם האפליקציה כבר רצה
- הסקריפט בודק אם הפורט 5000 תפוס
- אם האפליקציה כבר רצה, הוא פותח את הדפדפן ל-URL הנכון
- אם האפליקציה לא רצה, הוא מפעיל אותה

### 2. ניקוי תהליכים בעת סגירה
- בעת סגירת האפליקציה, כל התהליכים הקשורים נסגרים:
  - תהליכי Puppeteer/Chrome
  - תהליכי Node.js הקשורים לאפליקציה
  - שחרור הפורט 5000

## התקנה

### שלב 1: יצירת קיצור דרך בשולחן העבודה

1. פתח PowerShell כמנהל (או לא כמנהל - זה אמור לעבוד)
2. נווט לתיקיית הפרויקט:
   ```powershell
   cd D:\Wotti
   ```
3. הרץ את הסקריפט ליצירת קיצור דרך:
   ```powershell
   .\create-desktop-shortcut.ps1
   ```

זה ייצור קיצור דרך בשם "Wotti" על שולחן העבודה עם האייקון של האפליקציה.

### שלב 2: שימוש בקיצור דרך

פשוט לחץ פעמיים על האייקון "Wotti" בשולחן העבודה:
- אם האפליקציה כבר רצה → יפתח את הדפדפן
- אם האפליקציה לא רצה → יפתח את האפליקציה ואז את הדפדפן

## שימוש ידני

אם אתה רוצה להפעיל ידנית ללא קיצור דרך:

### אפשרות 1: הפעלה עם חלון קונסולה
```powershell
.\launch-wotti.ps1
```

### אפשרות 2: הפעלה ללא חלון קונסולה
```powershell
.\launch-wotti.vbs
```

או פשוט לחץ פעמיים על `launch-wotti.vbs` בסייר הקבצים.

## פתרון בעיות

### הסקריפט לא רץ
אם אתה מקבל שגיאת ExecutionPolicy:
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### האפליקציה לא נפתחת
1. ודא ש-Node.js מותקן
2. ודא ש-`npm install` בוצע
3. בדוק שהפורט 5000 לא תפוס על ידי אפליקציה אחרת

### תהליכים נשארים פתוחים
אם תהליכים נשארים פתוחים לאחר סגירה:
1. פתח Task Manager
2. חפש תהליכי "node.exe" או "chrome.exe"
3. סיים אותם ידנית

האפליקציה אמורה לנקות את כל התהליכים אוטומטית, אבל אם משהו נשאר, זה יפתור את הבעיה.

## קבצים שנוצרו

- `launch-wotti.ps1` - סקריפט ההפעלה הראשי
- `launch-wotti.bat` - קובץ batch wrapper
- `launch-wotti.vbs` - VBScript להפעלה שקטה
- `create-desktop-shortcut.ps1` - סקריפט ליצירת קיצור דרך
- `utils/processCleanup.js` - מודול לניקוי תהליכים
- שינויים ב-`index.js` - שיפור תהליך הכיבוי

## הערות

- הסקריפטים מיועדים ל-Windows
- האייקון נמצא ב-`assets/images/wotti-ico.ico`
- הפורט ברירת המחדל הוא 5000 (ניתן לשנות ב-`config/serverConfig.js`)

